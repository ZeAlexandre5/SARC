{% extends 'SARC/base.html' %}
{% load static %}
{% block content %}

<div class="container">
    <h1>Editar Reserva</h1>
    
    <div class="section">
        <h2>Detalhes da Reserva</h2>
        <form method="post">
            {% csrf_token %}
            {{ form.non_field_errors }}
            
            <div class="mb-3">
                <label class="form-label">{{ form.data.label }}</label>
                {{ form.data }}
                {{ form.data.errors }}
            </div>
            
            <div class="mb-3">
                <label class="form-label">{{ form.horario.label }}</label>
                {{ form.horario }}
                {{ form.horario.errors }}
            </div>
            
            <div class="mb-3">
                <label class="form-label">{{ form.sala.label }}</label>
                <input type="text" class="form-control" value="{{ reserva.sala.nome }}" disabled>
                {{ form.sala }} <!-- hidden field -->
                {{ form.sala.errors }}
            </div>
            
            <div class="mb-3">
                <label class="form-label">{{ form.computador.label }}</label>
                {{ form.computador }}
                {{ form.computador.errors }}
                <small class="form-text text-muted">
                    Computador atual: 
                    {% if reserva.computador %}
                        {{ reserva.computador.numero }}
                    {% else %}
                        Não selecionado
                    {% endif %}
                </small>
            </div>
            
            <div class="mb-3">
                <label class="form-label">{{ form.motivo.label }}</label>
                {{ form.motivo }}
                {{ form.motivo.errors }}
            </div>
            
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">Atualizar Reserva</button>
                <a href="{% url 'reservas' %}" class="btn btn-secondary">Cancelar</a>
                <a href="{% url 'cancelar_reserva' reserva.id_reserva %}" class="btn btn-danger ms-auto" 
                   onclick="return confirm('Tem certeza que deseja cancelar esta reserva?')">
                    Cancelar Reserva
                </a>
            </div>
        </form>
    </div>

    <div class="section">
        <h3>Informações da Reserva</h3>
        <div class="card">
            <div class="card-body">
                <p><strong>Usuário:</strong> {{ reserva.usuario.nome }}</p>
                <p><strong>Data original:</strong> {{ reserva.data|date:"d/m/Y" }}</p>
                <p><strong>Horário original:</strong> {{ reserva.horario|time:"H:i" }}</p>
                <p><strong>Sala:</strong> {{ reserva.sala.nome }}</p>
                <p><strong>Computador:</strong> 
                    {% if reserva.computador %}
                        {{ reserva.computador.numero }}
                    {% else %}
                        Não selecionado
                    {% endif %}
                </p>
                <p><strong>Status:</strong> 
                    {% if reserva.presenca %}
                        <span class="badge bg-success">Presente</span>
                    {% else %}
                        <span class="badge bg-warning">Pendente</span>
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
</div>

<style>
    .section {
        margin-bottom: 2rem;
        padding: 1.5rem;
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        background-color: #fff;
    }
    
    .card {
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
    }
    
    .badge {
        font-size: 0.875em;
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

{% endblock %}